Create a full-stack Node.js project named hr-teams-chat.
Deliver a runnable app with a Microsoft Teams–style UI (vanilla HTML/CSS/JS) and a Node/Express/Socket.IO backend.
Include Docker support: a top-level Dockerfile and docker-compose.yml that runs the backend and MongoDB in containers.
Default to in-memory storage so it runs instantly on Replit; if MONGO_URI is provided, persist to MongoDB (Atlas or self-hosted).

Files to generate

.replit
replit.nix
package.json
Dockerfile
docker-compose.yml
README.md
src/server.js
src/socket.js
src/services/hrBot.service.js
src/polls.js
public/index.html
public/styles.css
public/app.js

Backend requirements
	•	Node 20+, Express, Socket.IO, CORS, dotenv.
	•	Serve static files from /public at /.
	•	Rooms/Channels: general, hr-announcements.
	•	Socket events (client → server):
	•	joinRoom → { room, user: { name, role } }
	•	chatMessage → { room, text, user }
	•	poll:get → { room }
	•	poll:create → { room, question, options: string[] } (HR only)
	•	poll:vote → { pollId, room, optionIndex, user }
	•	poll:close → { pollId, room } (HR only)
	•	Socket events (server → clients in room):
	•	message → { user, role, text, createdAt }
	•	poll:active / poll:create / poll:update / poll:close → poll object
	•	Slash commands (HR bot) in hrBot.service.js:
	•	/leave balance → “You have 8 casual leaves and 2 earned leaves left.”
	•	/payslip <Month> 2025 → link: https://intranet.example.com/payslip/<user>
	•	/apply leave <N> days from <YYYY-MM-DD> → “Leave request submitted.”
	•	Reply as: { user: 'HR-Bot', role: 'system', text, createdAt }
	•	Announcements:
	•	If room === 'hr-announcements' and user.role !== 'HR', reject (don’t broadcast).
	•	Polls (one active per room):

{
  id: string,
  room: 'general' | 'hr-announcements',
  question: string,
  options: [{ label: string, votes: number }],
  isClosed: boolean
}

Broadcast lifecycle events on create/vote/close.

	•	Storage:
	•	If process.env.MONGO_URI exists → connect with Mongoose and persist Message and Poll.
	•	Else → use in-memory arrays/objects so it runs immediately on Replit.

Frontend (vanilla HTML/CSS/JS, Teams-style)
	•	3-pane layout: 56px rail | 260px sidebar (channels + user) | main chat pane.
	•	Sidebar:
	•	Name input + role select (Employee/HR) + “Set” (store to localStorage).
	•	Channel list: # general, # hr-announcements.
	•	Button: “+ New Poll (HR)” (enabled only if role=HR).
	•	Main chat:
	•	Top bar shows current room + “You (role)”.
	•	Poll panel above the messages: show active poll for the room (buttons with live counts). “Close Poll (HR)” visible only for HR.
	•	Message list with timestamps and role badges.
	•	Composer input + Send button. Disable composer in # hr-announcements if role≠HR.
	•	Message rendering rules:
	•	If text starts with /, render a small “Command” chip before the content.
	•	Plain text only (no media embeds).

Docker support (main element)
	•	Dockerfile (runs backend that also serves the static frontend):
	•	Base: node:20-alpine
	•	WORKDIR /app
	•	COPY package*.json . → npm install --production
	•	COPY . .
	•	ENV PORT=8000
	•	EXPOSE 8000
	•	CMD ["node", "src/server.js"]
	•	docker-compose.yml:
	•	backend service: build: ., ports 8000:8000, env MONGO_URI=mongodb://mongo:27017/hrchat, depends_on mongo.
	•	mongo service: image: mongo:7, ports 27017:27017, volume mongo_data:/data/db.
	•	Named volume mongo_data.
	•	App must run identically:
	•	On Replit (in-memory by default).
	•	With Docker (docker compose up --build) for containerized demo.

Replit config
	•	.replit: run = "node src/server.js"
	•	replit.nix: include Node + npm.

package.json
	•	"type": "module"
	•	scripts:
	•	"start": "node src/server.js"
	•	"dev": "nodemon src/server.js"
	•	dependencies: express, socket.io, cors, dotenv, mongoose
	•	devDependencies: nodemon

README.md (must include)
	•	Quick start on Replit: Click Run
	•	Optional: set MONGO_URI in Replit Secrets for persistence
	•	Docker usage:

docker compose up --build
# open http://localhost:8000
# docker ps -> shows backend + mongo containers


	•	Features list, socket event table, screenshots placeholders

Acceptance test

After generation and Run:
	1.	Open the webview → set name + role.
	2.	Switch # general / # hr-announcements.
	3.	Chat between two tabs in # general (Socket.IO real time).
	4.	Type /leave balance → HR-Bot replies.
	5.	As HR, click + New Poll (HR) → create → vote from another tab → see live counts.
	6.	Non-HR cannot send in # hr-announcements (composer disabled).
	7.	(Docker) Running docker compose up --build locally starts backend and mongo containers; app available on http://localhost:8000.

Generate all files with complete code now.
